#include "Floor.h"
#include "FloorTile.h"
#include "VertWall.h"
#include "HorizWall.h"
#include "Door.h"
#include "PassageWay.h"
#include "EmptyTile.h"

#include <memory>

static const std::string defaultLayout[25] = {
    "|-----------------------------------------------------------------------------|",
    "|                                                                             |",
    "| |--------------------------|        |-----------------------|               |",
    "| |..........................|        |.......................|               |",
    "| |..........................+########+.......................|-------|       |",
    "| |..........................|   #    |...............................|--|    |",
    "| |..........................|   #    |..................................|--| |",
    "| |----------+---------------|   #    |----+----------------|...............| |",
    "|            #                 #############                |...............| |",
    "|            #                 #     |-----+------|         |...............| |",
    "|            #                 #     |............|         |...............| |",
    "|            ###################     |............|   ######+...............| |",
    "|            #                 #     |............|   #     |...............| |",
    "|            #                 #     |-----+------|   #     |--------+------| |",
    "|  |---------+-----------|     #           #          #              #        |",
    "|  |.....................|     #           #          #         |----+------| |",
    "|  |.....................|     ########################         |...........| |",
    "|  |.....................|     #           #                    |...........| |",
    "|  |.....................|     #    |------+--------------------|...........| |",
    "|  |.....................|     #    |.......................................| |",
    "|  |.....................+##########+.......................................| |",
    "|  |.....................|          |.......................................| |",
    "|  |---------------------|          |---------------------------------------| |",
    "|                                                                             |",
    "|-----------------------------------------------------------------------------|"};

Floor::Floor() : tiles{std::vector<std::vector<Tile>>{}}
{
    for (int r = 0; r < 25; r++)
    {
        tiles.push_back(std::vector<Tile>{});
        for (int c = 0; c < 79; c++)
        {
            std::unique_ptr<Drawable> d;
            switch (defaultLayout[r][c])
            {
            case '.':
                d = std::make_unique<FloorTile>();
                break;
            case '|':
                d = std::make_unique<VertWall>();
                break;
            case '-':
                d = std::make_unique<HorizWall>();
                break;
            case '+':
                d = std::make_unique<Door>();
                break;
            case '#':
                d = std::make_unique<PassageWay>();
                break;
            case ' ':
                d = std::make_unique<EmptyTile>();
            }

            tiles[r].push_back(Tile{std::move(d), nullptr});
        }
    }
}

const Tile &Floor::getTile(int r, int c) const
{
    return tiles[r][c];
}